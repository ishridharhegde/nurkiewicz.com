---
layout: post
title: Java Coding Conventions considered harmful
date: '2012-10-18T20:03:00.001+02:00'
author: Tomasz Nurkiewicz
tags:
- sun
- oracle
modified_time: '2015-12-08T16:03:59.206+01:00'
thumbnail: http://4.bp.blogspot.com/-DmpIRdjKKA0/UIBD2TFcXUI/AAAAAAAAAnY/02eCPavXEwM/s72-c/100_8110.JPG
blogger_id: tag:blogger.com,1999:blog-6753769565491687768.post-5444026390381816081
blogger_orig_url: https://www.nurkiewicz.com/2012/10/java-coding-conventions-considered.html
---

<table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-DmpIRdjKKA0/UIBD2TFcXUI/AAAAAAAAAnY/02eCPavXEwM/s1600/100_8110.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://4.bp.blogspot.com/-DmpIRdjKKA0/UIBD2TFcXUI/AAAAAAAAAnY/02eCPavXEwM/s320/100_8110.JPG" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Tjuvholmen seen from a boat</td></tr></tbody></table>There is an official <a href="http://www.oracle.com/technetwork/java/codeconvtoc-136057.html">Code Conventions for the Java Programming Language</a> guide published on Oracle site. You would expect this 20+ pages document to be the most complete, comprehensive and authoritative source of good practices, hints and tips with regards to the Java language. But once you start to read it, disappointment followed by frustration and anger increases. I would like to point out the most obvious mistakes, bad practices, poor and outdated advices given in this guide. In case you are a Java beginner, just forget about this tutorial and look for better and more up-to-date reference materials. Let the horror begin!<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-137760.html#253"><i>2.2 Common File Names</i></a>:<br /><blockquote><code>GNUmakefile</code> The preferred name for makefiles. We use <code>gnumake</code> to build our software.</blockquote><code>gnumake</code> to build Java projects? <a href="http://ant.apache.org/">ant</a> is considered old-school, so is <a href="http://maven.apache.org/">maven</a>. Who uses <code>make</code> to build WARs, JARs, generate JavaDocs...?<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141855.html#3441"><i>3.1.1 Beginning Comments</i></a>:<br /><blockquote>All source files should begin with a c-style comment that lists the class name, version information, date, and copyright notice:</blockquote>Putting a class name in the comment starting a file? What if I change my mind and rename the class later? And what should that "<i>date</i>" represent? Some people use various placeholders to insert last modification time of a file automatically by version control system. Well, VCS is there to tell you when the file was created or last modified - and modifying the same line over and over again makes merging a huge pain.<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-136091.html#262"><i>4 - Indentation</i></a>:<br /><blockquote>Four spaces should be used as the unit of indentation. The exact construction of the indentation (spaces vs. tabs) is unspecified. Tabs must be set exactly every 8 spaces (not 4).</blockquote>Probably the most counterintuitive part of the document. Some prefer spaces, others (including me) - tabs. A matter of taste and team arrangements. But this guide suggests to use both and replace spaces with tabs, sometimes. It's "<i>unspecified</i>". My advice: use tabs and let each developer configure his IDE to have as big or as small indentations as desired.<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-136091.html#313"><i>4.1 Line Length</i></a>:<br /><blockquote>Avoid lines longer than 80 characters, since they're not handled well by many terminals and tools.</blockquote><br /><a name='more'></a>80 characters? My laptop can easily fit three times as much. Strive for 120-140 characters in one line, but don't use hard-wraps. Personally I just display vertical margin and the <i>right</i> line length is dictated by readability. BTW here are few examples of classes from various libraries and frameworks:<br /><ul><li><a href="http://docs.oracle.com/javase/7/docs/api/java/sql/SQLIntegrityConstraintViolationException.html"><code>SQLIntegrityConstraintViolationException</code></a> (JDK 7, 40 characters)<br /> </li><li><a href="http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/jdbc/core/support/AbstractInterruptibleBatchPreparedStatementSetter.html"><code>AbstractInterruptibleBatchPreparedStatementSetter</code></a> (Spring framework, 50 characters)<br /> </li><li><a href="http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/service/jdbc/connections/spi/AbstractDataSourceBasedMultiTenantConnectionProviderImpl.html"><code>AbstractDataSourceBasedMultiTenantConnectionProviderImpl</code></a> (Hibernate, 56 characters)<br /> </li><li><a href="http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/web/authentication/preauth/PreAuthenticatedGrantedAuthoritiesWebAuthenticationDetails.html"><code>PreAuthenticatedGrantedAuthoritiesWebAuthenticationDetails</code></a> (Spring Security, 58 characters)<br /> </li></ul>And we are suppose to fit whole line in 80 characters?<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141999.html#341"><i>5.1.2 Single-Line Comments</i></a>:<br /><pre class="brush: java">if (condition) {<br /><br />    /* Handle the condition. */<br />    ...<br />}<br /></pre>Just in case the code is not self-descriptive enough, I suggest even better comment:<br /><pre class="brush: java">if (condition) {<br /><br />    /* This block is executed if condition == true. */<br />    ...<br />}<br /></pre><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141999.html#342"><i>5.1.3 Trailing Comments</i></a>:<br /><pre class="brush: java">if (a == 2) {<br />    return TRUE;            /* special case */<br />} else {<br />    return isPrime(a);      /* works only for odd a */<br />}<br /></pre>Did you mean (and don't tell me it's less readable, even without comments)?<br /><pre class="brush: java">return a == 2 || isPrime(a);<br /></pre><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141270.html#2992"><i>6.1 Number Per Line</i></a>:<br /><pre class="brush: java">int level; // indentation level<br />int size;  // size of table<br /></pre>Why use descriptive variable names, when we have <i>comments</i>! Consider this instead:<br /><pre class="brush: java">int indentationLevel;<br />int tableSize;<br /></pre>Later in that section:<br /><blockquote>In absolutely no case should variables and functions be declared on the same line. Example:<br /><pre class="brush: java">long dbaddr, getDbaddr(); // WRONG!<br /></pre></blockquote>Sure it's wrong, it doesn't even compile. I'm surprised that "<i>don't put spaces in variable names</i>" is not mentioned as a good practice...<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141270.html#16817"><i>6.3 Placement</i></a>:<br /><blockquote>Put declarations only at the beginning of blocks. [...] Don't wait to declare variables until their first use; it can confuse the unwary programmer [...]</blockquote>This is how the coding conventions want you to write your code:<br /><pre class="brush: java">int min;            //inclusive<br />int max;            //exclusive<br />int distance;<br />List&lt;String&gt; list;  //one per each item<br /><br />min = findMin();<br />max = findMax();<br />distance = max - min;<br />list = new ArrayList&lt;&gt;(distance);<br />//...<br /></pre>And this is how it <i>should</i> be written to <i>avoid</i> confusion:<br /><pre class="brush: java">final int minInclusive = findMin();<br />final int maxExclusive = findMax();<br />final int distance = maxExclusive - minInclusive;<br />final List&lt;String&gt; listOfItems = new ArrayList&lt;&gt;(distance);<br />//...<br /></pre>Besides we can finally (<i>nomen est omen</i>) use <code>final</code> keyword. <a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141270.html#381">Later in this section</a> code sample is shown with class fields missing <code>private</code> modifier (default, package private access). Package private field?<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-142311.html#438"><i>7.3 return Statements</i></a>:<br /><pre class="brush: java">return (size ? size : defaultSize);<br /></pre>Maybe you haven't noticed, but from the context we can tell that both <code>size</code> and <code>defaultSize</code> are of <code>boolean</code> type. That's right, <code>size</code> and <code>defaultSize</code> can be either <code>true</code> or <code>false</code> (!) How counterintuitive is that! From such a document I would expect not only syntactical correctness, but also meaningful code and good practices! Moreover, the expression can be greatly simplified, <i>step-by-step</i>:<br /><pre class="brush: java">size ? size : defaultSize<br />size ? true : defaultSize<br />size || defaultSize<br /></pre><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-142311.html#454"><i>7.5 for Statements</i></a>:<br /><blockquote>An empty <code>for</code> statement (one in which all the work is done in the initialization, condition, and update clauses) should have the following form:<br /><pre class="brush: java">for (initialization; condition; update);<br /></pre></blockquote>"<i>empty <code>for</code> statement</i>"? Why would you ever use an empty <code>for</code> statement? This is <a href="http://stackoverflow.com/questions/12772221">confusing</a> and should be avoided, not encouraged and described in the official language guide.<br />Bonus quiz: what's the purpose of this code in C?<br /><pre class="brush: java">while(*dst++ = *src++);<br /></pre>I believe every computer programmer should understand the code snippet above. Even if you program in Ruby or TSQL.<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-142311.html#468"><i>7.8 switch Statements</i></a>:<br /><blockquote>Every time a <code>case</code> falls through (doesn't include a <code>break</code> statement), add a comment where the <code>break</code> statement would normally be.</blockquote>I understand the intentions, but the approach is wrong. Instead of documenting unexpected and error-prone code-fragments, just avoid them. Don't depend on fall through, don't use it at all.<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141388.html#487"><i>8.1 Blank Lines</i></a>:<br /><blockquote>One blank line should always be used in the following circumstances: <br />[...]<br /><ul><li>Between the local variables in a method and its first statement <br /> </li><li>Before a block [...] or single-line [...] comment <br /> </li><li>Between logical sections inside a method to improve readability<br /> </li></ul></blockquote>Looks like the authors suggest using blank lines to separate "<i>logical sections of a method</i>". Well, I call these sections: "<b>methods</b>". Don't group statements inside methods in blocks, comment them and separate from each other. Instead extract them into separate, well named methods!<br />Placing a blank line between variable declarations and the first statement sounds like taken from a C language book.<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141388.html#682"><i>8.2 Blank Spaces</i></a>:<br /><blockquote><ul><li>All binary operators except <code>.</code> should be separated from their operands by spaces. Blank spaces should never separate unary operators such as unary minus, increment ("<code>++</code>"), and decrement ("<code>--</code>") from their operands. Example:</li></ul>[...]<br /><pre class="brush: java">while (d++ = s++) {<br />  n++;<br />}<br /></pre></blockquote>This doesn't even <b>compile</b> in Java...<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367"><i>9 - Naming Conventions</i></a> (only in <a href="http://www.oracle.com/technetwork/java/codeconventions-150003.pdf">PDF version</a>):<br /><pre class="brush: java">char *cp;<br /></pre>A good name for a <code>char</code> pointer in Java is <code>cp</code>. Wait, <i>WAT</i>? <code>char</code> <b>pointer</b> in Java?<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-137265.html#177"><i>10.1 Providing Access to Instance and Class Variables</i></a>:<br /><blockquote>Don't make any instance or class variable public without good reason.</blockquote>Really, <i>really</i> good reason! Did I ever used <code>public</code> field?<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-137265.html#547"><i>10.4 Variable Assignments</i></a>:<br /><pre class="brush: java">if (c++ = d++) {        // AVOID! (Java disallows)<br />    ...<br />}<br /></pre>Great advice: please avoid using constructs that do not even compile in Java. This makes our lives so much easier!<br /><hr /><a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-137265.html#333"><i>10.5.2 Returning Values</i></a>:<br /><pre class="brush: java">if (booleanExpression) {<br />    return true;<br />} else {<br />    return false;<br />}<br /></pre><blockquote>should instead be written as </blockquote><pre class="brush: java">return booleanExpression;<br /></pre>Holy cow, <b>I AGREE!</b><br /><hr /><h5>Summary</h5>It's not that the official <i>Code Conventions for the Java Programming Language</i> are completely wrong. They are just outdated and obsolete. In the second decade of the XXI century we have better hardware, deeper understanding of code quality and more modern <a href="http://www.amazon.com/gp/product/0132350882/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0132350882&amp;linkCode=as2&amp;tag=javaandneighb-20">sources of wisdom</a>. <i>Code Conventions...</i> were last published in 1999, they are heavily inspired by C language, unaware of billions of lines of code yet to be written by millions of developers. Code conventions should emerge over time, just like design patterns, rather than be given explicitly. So please, don't quote or follow advices from official guide ever again. 